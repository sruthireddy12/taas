<html>
<body>
<div id="user_form" title="Users" style="display:none;">
   <%= render :partial => "new", :locals => {:user => User.new}%>
</div>
<div>
<div class="pull-right" id ="new_user">
  <button class="btn btn-primary btn-sm">
    New User
  </button>
</div>
<h3>Users</h3>
<table class="table table-striped" id='users_list'>
 <thead>
  <tr>
    <th>First Name</th>
    <th>Last Name</th>
        <th>
      <%= t("activerecord.attributes.user.email", :default => t("activerecord.labels.email", :default => "Email")) %>
    </th>
        <th>Mobile Number</th>
    <th>Actions</th>
  </tr>
  </thead>
  <tbody>
    <% @users.each do |user| -%>
      <%= render :partial => 'user', :locals => {:user => user} %>
    <% end -%>
  </tbody>
</table>
</div>

<script>
  $(function() {
    var dialog,form;
    function submitForm() {
      dialog.find("form").submit()
    }

    function clearForm(){
      $("#user_form").html("<%= escape_javascript(render :partial => 'new', :locals => {:user => User.new})%>");
    }

    dialog = $( "#user_form" ).dialog({
      autoOpen: false,
      height: 450,
      width: 450,
      modal: true,
      buttons: {
          "Create an account": submitForm,
          Cancel: function() {
            dialog.dialog( "close" );
          }
      },
      close: clearForm
    });

    $(document).on( "click", '#new_user', function() {
      dialog.dialog( "open" );
    });
  });
  </script>

  </body>
  </html>
